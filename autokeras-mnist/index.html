<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="https://firebasestorage.googleapis.com/v0/b/stellacoding1111.appspot.com/o/hexo%2Fstella-coding-logo-black-word-removebg.png?alt=media&token=c666151f-86ea-4033-abc1-d06be5041e2b">
  <link rel="icon" type="image/png" sizes="32x32" href="https://firebasestorage.googleapis.com/v0/b/stellacoding1111.appspot.com/o/hexo%2Fstella-coding-logo-black-word-removebg.png?alt=media&token=c666151f-86ea-4033-abc1-d06be5041e2b">
  <link rel="icon" type="image/png" sizes="16x16" href="https://firebasestorage.googleapis.com/v0/b/stellacoding1111.appspot.com/o/hexo%2Fstella-coding-logo-black-word-removebg.png?alt=media&token=c666151f-86ea-4033-abc1-d06be5041e2b">
  <link rel="mask-icon" href="https://firebasestorage.googleapis.com/v0/b/stellacoding1111.appspot.com/o/hexo%2Fstella-coding-logo-black-word-removebg.png?alt=media&token=c666151f-86ea-4033-abc1-d06be5041e2b" color="#222">

<link rel="stylesheet" href="/blog/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha256-XOqroi11tY4EFQMR9ZYwZWKj5ZXiftSx36RRuC3anlA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"estellacoding.github.io","root":"/blog/","images":"/blog/images","scheme":"Gemini","darkmode":false,"version":"8.20.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":true,"style":"mac"},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/blog/js/config.js"></script>

    <meta name="description" content="本系列是這本書「AutoML 自動化機器學習：用 AutoKeras 超輕鬆打造高效能 AI 模型」的學習筆記，並融入了我所補充整理的額外資料。 想了解 AutoML 的主要概念，請看 【AutoML】自動化機器學習 - AutoML入門。而本篇會介紹如何安裝 AutoKeras，並且怎麼用 AutoKeras 來訓練 MNIST 的圖像分類器和迴歸器。">
<meta property="og:type" content="article">
<meta property="og:title" content="AutoKeras 訓練 MNIST 的圖像分類器和迴歸器">
<meta property="og:url" content="https://estellacoding.github.io/blog/autokeras-mnist/index.html">
<meta property="og:site_name" content="Stella Coding">
<meta property="og:description" content="本系列是這本書「AutoML 自動化機器學習：用 AutoKeras 超輕鬆打造高效能 AI 模型」的學習筆記，並融入了我所補充整理的額外資料。 想了解 AutoML 的主要概念，請看 【AutoML】自動化機器學習 - AutoML入門。而本篇會介紹如何安裝 AutoKeras，並且怎麼用 AutoKeras 來訓練 MNIST 的圖像分類器和迴歸器。">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://firebasestorage.googleapis.com/v0/b/stellacoding1111.appspot.com/o/article%2FautoKeras-hello-mnist%2F1-autokeras-gpu-pycharm.png?alt=media&amp;token=46c3c0f3-611f-456b-861f-77c0839b1eef">
<meta property="og:image" content="https://firebasestorage.googleapis.com/v0/b/stellacoding1111.appspot.com/o/article%2FautoKeras-hello-mnist%2F2-autokeras-gpu-jupyter.png?alt=media&amp;token=bcc2e53b-4bb6-4c7b-8771-7e41fe0f0be9">
<meta property="og:image" content="https://firebasestorage.googleapis.com/v0/b/stellacoding1111.appspot.com/o/article%2FautoKeras-hello-mnist%2F4-hello-mnist-100.png?alt=media&amp;token=648776da-351e-4623-9cca-d4f57c0894b8">
<meta property="og:image" content="https://firebasestorage.googleapis.com/v0/b/stellacoding1111.appspot.com/o/article%2FautoKeras-hello-mnist%2F5-mnist-1234-train-test-image.png?alt=media&amp;token=e44c9acf-7f4e-4116-ae48-666bf6352514">
<meta property="og:image" content="https://firebasestorage.googleapis.com/v0/b/stellacoding1111.appspot.com/o/article%2FautoKeras-hello-mnist%2F6-mnist-data-distribution.png?alt=media&amp;token=3a1eb8d3-4634-4f07-b126-6480c692a498">
<meta property="og:image" content="https://firebasestorage.googleapis.com/v0/b/stellacoding1111.appspot.com/o/article%2FautoKeras-hello-mnist%2F7-mnist-classification-image-predicted.png?alt=media&amp;token=567c0452-b8e6-4f1a-bba9-1a6e869868f9">
<meta property="og:image" content="https://firebasestorage.googleapis.com/v0/b/stellacoding1111.appspot.com/o/article%2FautoKeras-hello-mnist%2F8-mnist-classification-plot-model.png?alt=media&amp;token=b20a56fe-12ab-43f1-9dcd-733fd1849a4b">
<meta property="og:image" content="https://firebasestorage.googleapis.com/v0/b/stellacoding1111.appspot.com/o/article%2FautoKeras-hello-mnist%2F9-mnist-classification-plot-model-show-more.png?alt=media&amp;token=02e86f95-5c36-4af9-a98e-44f202bab164">
<meta property="og:image" content="https://firebasestorage.googleapis.com/v0/b/stellacoding1111.appspot.com/o/article%2FautoKeras-hello-mnist%2F10-mnist-regression-image-predicted.png?alt=media&amp;token=ccba23be-08e8-4037-b998-c3802a36fee8">
<meta property="og:image" content="https://firebasestorage.googleapis.com/v0/b/stellacoding1111.appspot.com/o/article%2FautoKeras-hello-mnist%2F11-mnist-regression-plot-model.png?alt=media&amp;token=334e34ac-6218-4ab8-989f-554eb185f9c3">
<meta property="og:image" content="https://firebasestorage.googleapis.com/v0/b/stellacoding1111.appspot.com/o/article%2FautoKeras-hello-mnist%2F12-mnist-regression-plot-model-show-more.png?alt=media&amp;token=0c493681-8335-4484-985b-b9b423d4a1d7">
<meta property="article:published_time" content="2024-07-01T03:11:11.000Z">
<meta property="article:modified_time" content="2024-07-11T03:11:11.000Z">
<meta property="article:author" content="Stella">
<meta property="article:tag" content="AutoML">
<meta property="article:tag" content="Machine Learning">
<meta property="article:tag" content="Deep Learning">
<meta property="article:tag" content="AutoKeras">
<meta property="article:tag" content="MNIST">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://firebasestorage.googleapis.com/v0/b/stellacoding1111.appspot.com/o/article%2FautoKeras-hello-mnist%2F1-autokeras-gpu-pycharm.png?alt=media&amp;token=46c3c0f3-611f-456b-861f-77c0839b1eef">


<link rel="canonical" href="https://estellacoding.github.io/blog/autokeras-mnist/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://estellacoding.github.io/blog/autokeras-mnist/","path":"autokeras-mnist/","title":"AutoKeras 訓練 MNIST 的圖像分類器和迴歸器"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>AutoKeras 訓練 MNIST 的圖像分類器和迴歸器 | Stella Coding</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-EG0CKC3093"></script>
  <script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"G-EG0CKC3093","only_pageview":false,"measure_protocol_api_secret":null}</script>
  <script src="/blog/js/third-party/analytics/google-analytics.js"></script>








  <noscript>
    <link rel="stylesheet" href="/blog/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/blog/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Stella Coding</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Every step I walk through enhances my cognitive thinking!</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/blog/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/blog/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/blog/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-categories"><a href="/blog/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/blog/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AE%89%E8%A3%9D-AutoKeras"><span class="nav-number">1.</span> <span class="nav-text">安裝 AutoKeras</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Google-Colab"><span class="nav-number">1.1.</span> <span class="nav-text">Google Colab</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#PyCharm"><span class="nav-number">1.2.</span> <span class="nav-text">PyCharm</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Jupyter-Notebook"><span class="nav-number">1.3.</span> <span class="nav-text">Jupyter Notebook</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Hello-MNIST"><span class="nav-number">2.</span> <span class="nav-text">Hello MNIST</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%96%E5%BE%97-MNIST-%E8%B3%87%E6%96%99%E9%9B%86"><span class="nav-number">2.1.</span> <span class="nav-text">取得 MNIST 資料集</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%AA%A2%E8%A6%96%E5%9C%96%E5%83%8F%E5%85%A7%E5%AE%B9"><span class="nav-number">2.2.</span> <span class="nav-text">檢視圖像內容</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%B3%87%E6%96%99%E5%88%86%E5%B8%83%E6%83%85%E6%B3%81"><span class="nav-number">2.3.</span> <span class="nav-text">資料分布情況</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Hello-MNIST-%E5%9C%96%E5%83%8F%E5%88%86%E9%A1%9E%E5%99%A8"><span class="nav-number">3.</span> <span class="nav-text">Hello MNIST: 圖像分類器</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BA%96%E5%82%99%E7%92%B0%E5%A2%83"><span class="nav-number">3.1.</span> <span class="nav-text">準備環境</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%96%E5%BE%97-MNIST-%E8%B3%87%E6%96%99%E9%9B%86-v2"><span class="nav-number">3.2.</span> <span class="nav-text">取得 MNIST 資料集</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BB%BA%E7%BD%AE%E5%9C%96%E5%83%8F%E5%88%86%E9%A1%9E%E5%99%A8"><span class="nav-number">3.3.</span> <span class="nav-text">建置圖像分類器</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B8%AC%E8%A9%A6%E9%9B%86%E8%A9%95%E4%BC%B0%E6%A8%A1%E5%9E%8B%E6%95%88%E8%83%BD"><span class="nav-number">3.4.</span> <span class="nav-text">測試集評估模型效能</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A8%88%E7%AE%97%E9%A0%90%E6%B8%AC%E6%BA%96%E7%A2%BA%E7%8E%87"><span class="nav-number">3.4.1.</span> <span class="nav-text">計算預測準確率</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%8D%E5%9C%96%E5%83%8F%E5%81%9A%E5%87%BA%E9%A0%90%E6%B8%AC"><span class="nav-number">3.4.2.</span> <span class="nav-text">對圖像做出預測</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A8%A1%E5%9E%8B%E8%A6%96%E8%A6%BA%E5%8C%96"><span class="nav-number">3.5.</span> <span class="nav-text">模型視覺化</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A8%A1%E5%9E%8B%E6%9E%B6%E6%A7%8B%E8%A1%A8%E6%A0%BC"><span class="nav-number">3.5.1.</span> <span class="nav-text">模型架構表格</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A8%A1%E5%9E%8B%E6%9E%B6%E6%A7%8B%E5%9C%96"><span class="nav-number">3.5.2.</span> <span class="nav-text">模型架構圖</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Hello-MNIST-%E5%9C%96%E5%83%8F%E8%BF%B4%E6%AD%B8%E5%99%A8"><span class="nav-number">4.</span> <span class="nav-text">Hello MNIST: 圖像迴歸器</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BA%96%E5%82%99%E7%92%B0%E5%A2%83-v2"><span class="nav-number">4.1.</span> <span class="nav-text">準備環境</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%96%E5%BE%97-MNIST-%E8%B3%87%E6%96%99%E9%9B%86-v3"><span class="nav-number">4.2.</span> <span class="nav-text">取得 MNIST 資料集</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BB%BA%E7%BD%AE%E5%9C%96%E5%83%8F%E8%BF%B4%E6%AD%B8%E5%99%A8"><span class="nav-number">4.3.</span> <span class="nav-text">建置圖像迴歸器</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B8%AC%E8%A9%A6%E9%9B%86%E8%A9%95%E4%BC%B0%E6%A8%A1%E5%9E%8B%E6%95%88%E8%83%BD-v2"><span class="nav-number">4.4.</span> <span class="nav-text">測試集評估模型效能</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A8%88%E7%AE%97%E5%9D%87%E6%96%B9%E8%AA%A4%E5%B7%AE"><span class="nav-number">4.4.1.</span> <span class="nav-text">計算均方誤差</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%8D%E5%9C%96%E5%83%8F%E5%81%9A%E5%87%BA%E9%A0%90%E6%B8%AC-v2"><span class="nav-number">4.4.2.</span> <span class="nav-text">對圖像做出預測</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A8%A1%E5%9E%8B%E8%A6%96%E8%A6%BA%E5%8C%96-v2"><span class="nav-number">4.5.</span> <span class="nav-text">模型視覺化</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A8%A1%E5%9E%8B%E6%9E%B6%E6%A7%8B%E8%A1%A8%E6%A0%BC-v2"><span class="nav-number">4.5.1.</span> <span class="nav-text">模型架構表格</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A8%A1%E5%9E%8B%E6%9E%B6%E6%A7%8B%E5%9C%96-v2"><span class="nav-number">4.5.2.</span> <span class="nav-text">模型架構圖</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%B8%BD%E7%B5%90"><span class="nav-number">5.</span> <span class="nav-text">總結</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Stella"
      src="https://firebasestorage.googleapis.com/v0/b/stellacoding1111.appspot.com/o/hexo%2Fstellacoding_logo_v1.png?alt=media&token=ae90d59c-5e7c-4d67-86a7-b87035725b96">
  <p class="site-author-name" itemprop="name">Stella</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/blog/archives/">
          <span class="site-state-item-count">24</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/blog/categories/">
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/blog/tags/">
        <span class="site-state-item-count">60</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/estellacoding" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;estellacoding" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.instagram.com/stellacoding/" title="Instagram → https:&#x2F;&#x2F;www.instagram.com&#x2F;stellacoding&#x2F;" rel="noopener me" target="_blank"><i class="fab fa-instagram fa-fw"></i>Instagram</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://estellacoding.github.io/blog/autokeras-mnist/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://firebasestorage.googleapis.com/v0/b/stellacoding1111.appspot.com/o/hexo%2Fstellacoding_logo_v1.png?alt=media&token=ae90d59c-5e7c-4d67-86a7-b87035725b96">
      <meta itemprop="name" content="Stella">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Stella Coding">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="AutoKeras 訓練 MNIST 的圖像分類器和迴歸器 | Stella Coding">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          AutoKeras 訓練 MNIST 的圖像分類器和迴歸器
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-07-01 11:11:11" itemprop="dateCreated datePublished" datetime="2024-07-01T11:11:11+08:00">2024-07-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-07-11 11:11:11" itemprop="dateModified" datetime="2024-07-11T11:11:11+08:00">2024-07-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/AutoML/" itemprop="url" rel="index"><span itemprop="name">AutoML</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>本系列是這本書「<a target="_blank" rel="noopener" href="https://www.books.com.tw/products/0010911296">AutoML 自動化機器學習：用 AutoKeras 超輕鬆打造高效能 AI 模型</a>」的學習筆記，並融入了我所補充整理的額外資料。</p>
<p>想了解 AutoML 的主要概念，請看 <a href="https://estellacoding.github.io/blog/automl-introduction/">【AutoML】自動化機器學習 - AutoML入門</a>。而本篇會介紹如何安裝 AutoKeras，並且怎麼用 AutoKeras 來訓練 MNIST 的圖像分類器和迴歸器。</p>
<span id="more"></span>
<h1 id="安裝-AutoKeras"><a class="header-anchor" href="#安裝-AutoKeras"></a>安裝 AutoKeras</h1>
<h2 id="Google-Colab"><a class="header-anchor" href="#Google-Colab"></a>Google Colab</h2>
<p>使用 <a target="_blank" rel="noopener" href="https://colab.research.google.com/notebooks/welcome.ipynb?hl=zh-TW">GoogleColaboratory</a> 進行機器學習訓練是一種方便的選擇。</p>
<ul>
<li>Colab 讓你可以連接到一個執行階段(runtime)，實際上是一個虛擬機。Notebook 檔案會自動保存到你的 Google 雲端硬碟中，在瀏覽器中即可使用，分享給別人也很方便。</li>
<li>虛擬機如果閒置過久或連續使用超過 12 小時，虛擬機會斷線並被系統收回。</li>
<li>Colab 支援的 GPU 和 TPU 資源會優先分配給付費用戶，f免費用戶不一定隨時可用。</li>
</ul>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Install AutoKeras</span></span><br><span class="line">!pip3 <span class="keyword">install</span> autokeras</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">import</span> autokeras <span class="keyword">as</span> ak</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印 TensorFlow 版本</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;TensorFlow version:&quot;</span>, tf.__version__)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 检查是否有可用的 GPU</span></span><br><span class="line">gpus = tf.config.list_physical_devices(<span class="string">&#x27;GPU&#x27;</span>)</span><br><span class="line"><span class="keyword">if</span> gpus:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;GPUs are available.&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> gpu <span class="keyword">in</span> gpus:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;GPU: <span class="subst">&#123;gpu&#125;</span>&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;No GPUs are available.&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印 AutoKeras 版本</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;AutoKeras version:&quot;</span>, ak.__version__)</span><br></pre></td></tr></table></figure>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">TensorFlow</span> version: <span class="number">2</span>.<span class="number">16</span>.<span class="number">2</span></span><br><span class="line"><span class="attribute">GPUs</span> are available.</span><br><span class="line"><span class="attribute">GPU</span>: PhysicalDevice(name=&#x27;/physical_device:GPU:<span class="number">0</span>&#x27;, device_type=&#x27;GPU&#x27;)</span><br><span class="line"><span class="attribute">AutoKeras</span> version: <span class="number">2</span>.<span class="number">0</span>.<span class="number">0</span></span><br></pre></td></tr></table></figure>
<h2 id="PyCharm"><a class="header-anchor" href="#PyCharm"></a>PyCharm</h2>
<p>本地端安裝 <code>autokeras</code> 容易出現錯誤，建議是創建一個新的虛擬環境，以免套件間版本互不相容造成錯誤。另外，我是安裝 <code>autokeras==1.0.20</code> 才成功的。</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">pip</span> install autokeras==<span class="number">1</span>.<span class="number">0</span>.<span class="number">20</span></span><br></pre></td></tr></table></figure>
<p>因為目前安裝 <code>autokeras</code>時，會自動連同 TensorFlow 一起下載，因為我們想要使用 TensorFlow GPU 版本，所以我們需要再安裝 <code>tensorflow-gpu==2.10.0</code>。</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">pip</span> uninstall tensorflow -y</span><br><span class="line"><span class="attribute">pip</span> uninstall tensorflow-intel -y</span><br><span class="line"><span class="attribute">pip</span> install tensorflow-gpu==<span class="number">2</span>.<span class="number">10</span>.<span class="number">0</span></span><br></pre></td></tr></table></figure>
<p>確認 AutoKeras 版本及是否支援 GPU。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">import</span> autokeras <span class="keyword">as</span> ak</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印 TensorFlow 版本</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;TensorFlow version:&quot;</span>, tf.__version__)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 檢查是否有可用的 GPU</span></span><br><span class="line">gpus = tf.config.list_physical_devices(<span class="string">&#x27;GPU&#x27;</span>)</span><br><span class="line"><span class="keyword">if</span> gpus:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;GPUs are available.&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> gpu <span class="keyword">in</span> gpus:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;GPU: <span class="subst">&#123;gpu&#125;</span>&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;No GPUs are available.&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印 AutoKeras 版本</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;AutoKeras version:&quot;</span>, ak.__version__)</span><br></pre></td></tr></table></figure>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">TensorFlow</span> version: <span class="number">2</span>.<span class="number">10</span>.<span class="number">0</span></span><br><span class="line"><span class="attribute">GPUs</span> are available.</span><br><span class="line"><span class="attribute">GPU</span>: PhysicalDevice(name=&#x27;/physical_device:GPU:<span class="number">0</span>&#x27;, device_type=&#x27;GPU&#x27;)</span><br><span class="line"><span class="attribute">AutoKeras</span> version: <span class="number">1</span>.<span class="number">0</span>.<span class="number">20</span></span><br></pre></td></tr></table></figure>
<p><img src="https://firebasestorage.googleapis.com/v0/b/stellacoding1111.appspot.com/o/article%2FautoKeras-hello-mnist%2F1-autokeras-gpu-pycharm.png?alt=media&amp;token=46c3c0f3-611f-456b-861f-77c0839b1eef" alt="1-autokeras-gpu-pycharm"></p>
<p>關於如何在本地端啟動 GPU，請看 <a href="https://estellacoding.github.io/blog/win11-activate-nvidia-mx450-gpu-locally">Win11 本地端啟動 NVIDIA MX450 GPU 的詳細步驟</a>。</p>
<h2 id="Jupyter-Notebook"><a class="header-anchor" href="#Jupyter-Notebook"></a>Jupyter Notebook</h2>
<p>Conda 建立虛擬環境。</p>
<figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">conda create -n autokeras-<span class="keyword">env</span> <span class="keyword">python</span>=<span class="number">3.9</span></span><br><span class="line">conda activate autokeras-<span class="keyword">env</span></span><br></pre></td></tr></table></figure>
<p>安裝 Jupyer Notebook。</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda <span class="keyword">install</span> jupyter</span><br></pre></td></tr></table></figure>
<p>安裝 AutoKeras。在 Anaconda 環境下，無法直接安裝 <code>autokeras</code>，會出現 <code> error: subprocess-exited-with-error</code> 錯誤。要使用以下指令安裝<code>autokeras</code>。</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda install -c conda-forge <span class="built_in">auto</span>keras</span><br></pre></td></tr></table></figure>
<p>因為目前安裝 <code>autokeras</code>時，會自動連同 TensorFlow 一起下載，因為我們想要使用 TensorFlow GPU 版本，所以我們需要再安裝 <code>tensorflow-gpu==2.10.0</code>。</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">!pip install <span class="attribute">tensorflow-gpu</span>==2.10.0</span><br></pre></td></tr></table></figure>
<p>確認 AutoKeras 版本及是否支援 GPU。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">import</span> autokeras <span class="keyword">as</span> ak</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印 TensorFlow 版本</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;TensorFlow version:&quot;</span>, tf.__version__)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 检查是否有可用的 GPU</span></span><br><span class="line">gpus = tf.config.list_physical_devices(<span class="string">&#x27;GPU&#x27;</span>)</span><br><span class="line"><span class="keyword">if</span> gpus:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;GPUs are available.&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> gpu <span class="keyword">in</span> gpus:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;GPU: <span class="subst">&#123;gpu&#125;</span>&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;No GPUs are available.&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印 AutoKeras 版本</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;AutoKeras version:&quot;</span>, ak.__version__)</span><br></pre></td></tr></table></figure>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">TensorFlow</span> version: <span class="number">2</span>.<span class="number">10</span>.<span class="number">0</span></span><br><span class="line"><span class="attribute">GPUs</span> are available.</span><br><span class="line"><span class="attribute">GPU</span>: PhysicalDevice(name=&#x27;/physical_device:GPU:<span class="number">0</span>&#x27;, device_type=&#x27;GPU&#x27;)</span><br><span class="line"><span class="attribute">AutoKeras</span> version: <span class="number">1</span>.<span class="number">0</span>.<span class="number">20</span></span><br></pre></td></tr></table></figure>
<p><img src="https://firebasestorage.googleapis.com/v0/b/stellacoding1111.appspot.com/o/article%2FautoKeras-hello-mnist%2F2-autokeras-gpu-jupyter.png?alt=media&amp;token=bcc2e53b-4bb6-4c7b-8771-7e41fe0f0be9" alt="2-autokeras-gpu-jupyter"></p>
<p>關於如何在本地端啟動 GPU，並使用 Jupyter Notebook 驗證 TensorFlow 是否可用 GPU，請看 <a href="https://estellacoding.github.io/blog/win11-activate-nvidia-mx450-gpu-locally/#%E9%A9%97%E8%AD%89-TensorFlow-%E5%8F%AF%E7%94%A8-GPU">Win11 本地端啟動 NVIDIA MX450 GPU 的詳細步驟- 驗證 TensorFlow 可用 GPU</a>。</p>
<h1 id="Hello-MNIST"><a class="header-anchor" href="#Hello-MNIST"></a>Hello MNIST</h1>
<ul>
<li>MNIST 是手寫數字(0~9)的圖片的資料集。</li>
<li>由美國國家標準暨技術研究院於 1980 年代收集。</li>
<li>包含 70,000 張圖像，其中 60,000 張訓練圖像和 10,000 張測試圖像。</li>
<li>每張圖像都是 28×28 像素的灰階圖片。</li>
</ul>
<p><img src="https://firebasestorage.googleapis.com/v0/b/stellacoding1111.appspot.com/o/article%2FautoKeras-hello-mnist%2F4-hello-mnist-100.png?alt=media&amp;token=648776da-351e-4623-9cca-d4f57c0894b8" alt="4-hello-mnist-100"></p>
<h2 id="取得-MNIST-資料集"><a class="header-anchor" href="#取得-MNIST-資料集"></a>取得 MNIST 資料集</h2>
<p><code>mnist.load_data()</code> 會回傳 <code>x_train</code>、<code>y_train</code>、<code>x_test</code>、<code>y_test</code> 4 個 ndarray 陣列。</p>
<table>
<thead>
<tr>
<th>資料集</th>
<th>x_train</th>
<th>y_train</th>
<th>x_test</th>
<th>y_test</th>
</tr>
</thead>
<tbody>
<tr>
<td>意義</td>
<td>訓練集資料</td>
<td>訓練集標籤</td>
<td>測試集資料</td>
<td>測試集標籤</td>
</tr>
</tbody>
</table>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(x_train, y_train), (x_test, y_test) = mnist<span class="selector-class">.load_data</span>()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(x_train.shape)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(x_test.shape)</span></span></span><br></pre></td></tr></table></figure>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Downloading data from https:<span class="regexp">//</span>storage.googleapis.com<span class="regexp">/tensorflow/</span>tf-keras-datasets/mnist.npz</span><br><span class="line"><span class="number">11490434</span><span class="regexp">/11490434 ━━━━━━━━━━━━━━━━━━━━ 0s 0us/</span>step</span><br><span class="line">(<span class="number">60000</span>, <span class="number">28</span>, <span class="number">28</span>) <span class="comment"># 訓練集: 60000 張圖片，每張圖片 28x28 像素</span></span><br><span class="line">(<span class="number">10000</span>, <span class="number">28</span>, <span class="number">28</span>) <span class="comment"># 測試集: 10000 張圖片，每張圖片 28x28 像素</span></span><br></pre></td></tr></table></figure>
<h2 id="檢視圖像內容"><a class="header-anchor" href="#檢視圖像內容"></a>檢視圖像內容</h2>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 產生畫布</span></span><br><span class="line"><span class="attribute">fig</span> = plt.figure()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 產生左子畫布</span></span><br><span class="line"><span class="attribute">ax</span> = fig.add_subplot(<span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>)</span><br><span class="line"><span class="comment"># 畫出訓練集第 1234 張圖片，設為灰階圖片</span></span><br><span class="line"><span class="attribute">plt</span>.imshow(x_train[<span class="number">1234</span>], cmap=&#x27;gray&#x27;)</span><br><span class="line"><span class="comment"># 設定子畫布標題</span></span><br><span class="line"><span class="attribute">ax</span>.set_title(f&#x27;Train sample: &#123;y_train[<span class="number">1234</span>]&#125;&#x27;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 產生右子畫布</span></span><br><span class="line"><span class="attribute">ax</span> = fig.add_subplot(<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>)</span><br><span class="line"><span class="comment"># 畫出測試集第 1234 張圖片，設為灰階圖片</span></span><br><span class="line"><span class="attribute">plt</span>.imshow(x_test[<span class="number">1234</span>], cmap=&#x27;gray&#x27;)</span><br><span class="line"><span class="comment"># 設定子畫布標題</span></span><br><span class="line"><span class="attribute">ax</span>.set_title(f&#x27;Test sample: &#123;y_test[<span class="number">1234</span>]&#125;&#x27;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 顯示圖片</span></span><br><span class="line"><span class="attribute">plt</span>.show()</span><br></pre></td></tr></table></figure>
<p><img src="https://firebasestorage.googleapis.com/v0/b/stellacoding1111.appspot.com/o/article%2FautoKeras-hello-mnist%2F5-mnist-1234-train-test-image.png?alt=media&amp;token=e44c9acf-7f4e-4116-ae48-666bf6352514" alt="5-mnist-1234-train-test-image"></p>
<h2 id="資料分布情況"><a class="header-anchor" href="#資料分布情況"></a>資料分布情況</h2>
<p>繪製 MNIST 訓練集和測試集的直方圖。</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 產生畫布</span></span><br><span class="line"><span class="attribute">fig</span> = plt.figure()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 產生0~10的資料代表區間</span></span><br><span class="line"><span class="attribute">bin</span> = np.arange(<span class="number">11</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 新增第1個子圖，位置為1行2列中的第1個</span></span><br><span class="line"><span class="attribute">ax</span> = fig.add_subplot(<span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>)</span><br><span class="line"><span class="comment"># 設定x軸的刻度為0~10</span></span><br><span class="line"><span class="attribute">ax</span>.set_xticks(bin)</span><br><span class="line"><span class="comment"># 繪製訓練資料的直方圖: bins直方圖分幾欄, rwidth長條寬度</span></span><br><span class="line"><span class="attribute">plt</span>.hist(y_train, bins=bin-<span class="number">0</span>.<span class="number">5</span>, rwidth=<span class="number">0</span>.<span class="number">9</span>)</span><br><span class="line"><span class="comment"># 第一個子圖標題</span></span><br><span class="line"><span class="attribute">ax</span>.set_title(&#x27;Train dataset histogram&#x27;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 新增第2個子圖，位置為1行2列中的第2個</span></span><br><span class="line"><span class="attribute">ax</span> = fig.add_subplot(<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>)</span><br><span class="line"><span class="attribute">ax</span>.set_xticks(bin)</span><br><span class="line"><span class="attribute">plt</span>.hist(y_test, bins=bin-<span class="number">0</span>.<span class="number">5</span>, rwidth=<span class="number">0</span>.<span class="number">9</span>)</span><br><span class="line"><span class="attribute">ax</span>.set_title(&#x27;Test dataset histogram&#x27;)</span><br><span class="line"></span><br><span class="line"><span class="attribute">plt</span>.show()</span><br></pre></td></tr></table></figure>
<p>看起來 MNIST 訓練集和測試集的資料分布是相近的。</p>
<p><img src="https://firebasestorage.googleapis.com/v0/b/stellacoding1111.appspot.com/o/article%2FautoKeras-hello-mnist%2F6-mnist-data-distribution.png?alt=media&amp;token=3a1eb8d3-4634-4f07-b126-6480c692a498" alt="6-mnist-data-distribution"></p>
<p>以下我是用 Google Colab 來訓練 MNIST 的圖像分類器和迴歸器。</p>
<h1 id="Hello-MNIST-圖像分類器"><a class="header-anchor" href="#Hello-MNIST-圖像分類器"></a>Hello MNIST: 圖像分類器</h1>
<h2 id="準備環境"><a class="header-anchor" href="#準備環境"></a>準備環境</h2>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">!pip3 install <span class="built_in">auto</span>keras</span><br></pre></td></tr></table></figure>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Successfully</span> installed autokeras-<span class="number">2</span>.<span class="number">0</span>.<span class="number">0</span> h5py-<span class="number">3</span>.<span class="number">11</span>.<span class="number">0</span> keras-<span class="number">3</span>.<span class="number">4</span>.<span class="number">1</span> keras-nlp-<span class="number">0</span>.<span class="number">14</span>.<span class="number">0</span> keras-tuner-<span class="number">1</span>.<span class="number">4</span>.<span class="number">7</span> kt-legacy-<span class="number">1</span>.<span class="number">0</span>.<span class="number">5</span> ml-dtypes-<span class="number">0</span>.<span class="number">3</span>.<span class="number">2</span> namex-<span class="number">0</span>.<span class="number">0</span>.<span class="number">8</span> optree-<span class="number">0</span>.<span class="number">11</span>.<span class="number">0</span> tensorboard-<span class="number">2</span>.<span class="number">16</span>.<span class="number">2</span> tensorflow-<span class="number">2</span>.<span class="number">16</span>.<span class="number">2</span> tensorflow-text-<span class="number">2</span>.<span class="number">16</span>.<span class="number">1</span></span><br></pre></td></tr></table></figure>
<figure class="highlight elm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="title">from</span> tensorflow.keras.datasets <span class="keyword">import</span> mnist</span><br><span class="line"><span class="keyword">import</span> autokeras <span class="keyword">as</span> ak</span><br></pre></td></tr></table></figure>
<h2 id="取得-MNIST-資料集-v2"><a class="header-anchor" href="#取得-MNIST-資料集-v2"></a>取得 MNIST 資料集</h2>
<figure class="highlight fix"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">(x_train, y_train), (x_test, y_test) </span>=<span class="string"> mnist.load_data()</span></span><br></pre></td></tr></table></figure>
<h2 id="建置圖像分類器"><a class="header-anchor" href="#建置圖像分類器"></a>建置圖像分類器</h2>
<p>為了加快訓練時間，將以下參數設定較小。(即便調小，用 Colab CPU 跑也需要跑2小時左右!)</p>
<ul>
<li>分類器 <code>max_trials</code> 設定只嘗試1種 Keras 模型。</li>
<li><code>epoch</code> 設定為10個模型訓練週期。</li>
</ul>
<p>不過實際在進行模型訓練時，應該將以下參數設定較大。</p>
<ul>
<li>分類器 <code>max_trials</code> (預設為100)。</li>
<li><code>epochs</code> (預設上限為1000)，但可能提前結束。
<ul>
<li>AutoKeras 發現模型在訓練一段時間後都無法進步的話，也會自動停止訓練。</li>
</ul>
</li>
</ul>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 建置圖像分類器，只嘗試1種Keras模型</span></span><br><span class="line">clf = ak.ImageClassifier(<span class="attribute">max_trials</span>=1)</span><br><span class="line"><span class="comment"># 開始訓練，訓練10個週期</span></span><br><span class="line">clf.fit(x_train, y_train, <span class="attribute">epochs</span>=10)</span><br></pre></td></tr></table></figure>
<p>訓練過程中，會輸出目前模型使用的超參數，包含目前表現最佳的模型。</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 測試第1個模型</span></span><br><span class="line"><span class="attribute">Search</span>: Running Trial #<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 目前目前模型使用的超參數，包含目前表現最佳的模型</span></span><br><span class="line"><span class="attribute">Value</span>             |Best Value So Far |Hyperparameter</span><br><span class="line"><span class="attribute">vanilla</span>           |vanilla           |image_block_1/block_type</span><br><span class="line"><span class="attribute">True</span>              |True              |image_block_1/normalize</span><br><span class="line"><span class="attribute">False</span>             |False             |image_block_1/augment</span><br><span class="line"><span class="attribute">3</span>                 |<span class="number">3</span>                 |image_block_1/conv_block_1/kernel_size</span><br><span class="line"><span class="attribute">1</span>                 |<span class="number">1</span>                 |image_block_1/conv_block_1/num_blocks</span><br><span class="line"><span class="attribute">2</span>                 |<span class="number">2</span>                 |image_block_1/conv_block_1/num_layers</span><br><span class="line"><span class="attribute">True</span>              |True              |image_block_1/conv_block_1/max_pooling</span><br><span class="line"><span class="attribute">False</span>             |False             |image_block_1/conv_block_1/separable</span><br><span class="line"><span class="attribute">0</span>.<span class="number">25</span>              |<span class="number">0</span>.<span class="number">25</span>              |image_block_1/conv_block_1/dropout</span><br><span class="line"><span class="attribute">32</span>                |<span class="number">32</span>                |image_block_1/conv_block_1/filters_0_0</span><br><span class="line"><span class="attribute">64</span>                |<span class="number">64</span>                |image_block_1/conv_block_1/filters_0_1</span><br><span class="line"><span class="attribute">flatten</span>           |flatten           |classification_head_1/spatial_reduction_1/reduction_type</span><br><span class="line"><span class="attribute">0</span>.<span class="number">5</span>               |<span class="number">0</span>.<span class="number">5</span>               |classification_head_1/dropout</span><br><span class="line"><span class="attribute">adam</span>              |adam              |optimizer</span><br><span class="line"><span class="attribute">0</span>.<span class="number">001</span>             |<span class="number">0</span>.<span class="number">001</span>             |learning_rate</span><br><span class="line"></span><br><span class="line"><span class="attribute">Epoch</span> <span class="number">1</span>/<span class="number">10</span> # 第<span class="number">1</span>週期訓練</span><br><span class="line"><span class="attribute">1500</span>/<span class="number">1500</span> ━━━━━━━━━━━━━━━━━━━━ <span class="number">13</span>s <span class="number">4</span>ms/step - accuracy: <span class="number">0</span>.<span class="number">8984</span> - loss: <span class="number">0</span>.<span class="number">3295</span> - val_accuracy: <span class="number">0</span>.<span class="number">9813</span> - val_loss: <span class="number">0</span>.<span class="number">0660</span></span><br><span class="line"><span class="attribute">Epoch</span> <span class="number">2</span>/<span class="number">10</span></span><br><span class="line"><span class="attribute">1500</span>/<span class="number">1500</span> ━━━━━━━━━━━━━━━━━━━━ <span class="number">6</span>s <span class="number">4</span>ms/step - accuracy: <span class="number">0</span>.<span class="number">9744</span> - loss: <span class="number">0</span>.<span class="number">0827</span> - val_accuracy: <span class="number">0</span>.<span class="number">9863</span> - val_loss: <span class="number">0</span>.<span class="number">0491</span></span><br><span class="line"><span class="attribute">Epoch</span> <span class="number">3</span>/<span class="number">10</span></span><br><span class="line"><span class="attribute">1500</span>/<span class="number">1500</span> ━━━━━━━━━━━━━━━━━━━━ <span class="number">5</span>s <span class="number">3</span>ms/step - accuracy: <span class="number">0</span>.<span class="number">9797</span> - loss: <span class="number">0</span>.<span class="number">0633</span> - val_accuracy: <span class="number">0</span>.<span class="number">9879</span> - val_loss: <span class="number">0</span>.<span class="number">0466</span></span><br><span class="line"><span class="attribute">Epoch</span> <span class="number">4</span>/<span class="number">10</span></span><br><span class="line"><span class="attribute">1500</span>/<span class="number">1500</span> ━━━━━━━━━━━━━━━━━━━━ <span class="number">6</span>s <span class="number">4</span>ms/step - accuracy: <span class="number">0</span>.<span class="number">9830</span> - loss: <span class="number">0</span>.<span class="number">0551</span> - val_accuracy: <span class="number">0</span>.<span class="number">9889</span> - val_loss: <span class="number">0</span>.<span class="number">0418</span></span><br><span class="line"><span class="attribute">Epoch</span> <span class="number">5</span>/<span class="number">10</span></span><br><span class="line"><span class="attribute">1500</span>/<span class="number">1500</span> ━━━━━━━━━━━━━━━━━━━━ <span class="number">5</span>s <span class="number">3</span>ms/step - accuracy: <span class="number">0</span>.<span class="number">9854</span> - loss: <span class="number">0</span>.<span class="number">0475</span> - val_accuracy: <span class="number">0</span>.<span class="number">9869</span> - val_loss: <span class="number">0</span>.<span class="number">0442</span></span><br><span class="line"><span class="attribute">Epoch</span> <span class="number">6</span>/<span class="number">10</span></span><br><span class="line"><span class="attribute">1500</span>/<span class="number">1500</span> ━━━━━━━━━━━━━━━━━━━━ <span class="number">6</span>s <span class="number">4</span>ms/step - accuracy: <span class="number">0</span>.<span class="number">9866</span> - loss: <span class="number">0</span>.<span class="number">0423</span> - val_accuracy: <span class="number">0</span>.<span class="number">9876</span> - val_loss: <span class="number">0</span>.<span class="number">0460</span></span><br></pre></td></tr></table></figure>
<blockquote><ol>
<li>在訓練過程中，我們可以觀察到4個指標: <code>loss</code>(訓練集損失值)、<code>accuracy</code>(訓練集預測準確率)、<code>val_loss</code>(驗證集損失值)和 <code>val_accuracy</code>(驗證集準確率)。</li>
<li>AutoKeras 會將原始訓練集(60,000 張訓練圖像)自動拆成2個部份:
<ul>
<li>訓練集: 80%(48,000 筆資料)。</li>
<li>驗證集: 20%(12,000 筆資料)。</li>
</ul>
</li>
<li>AutoKeras 將批次大小設為32，每個週期訓練1500個批次(=48,000/32)。</li>
<li>驗證集在每個週期訓練完後，用於測試模型的泛化能力(Generalization)，以評估該週期的訓練效果，或決定是否需要中止訓練。
<ul>
<li>多數 AutoKeras 模型會嘗試將 <code>val_loss</code> 最小化，驗證集損失值 <code>val_loss</code> 是目前的分類模型訓練的目標指標(objective)。</li>
<li>使用驗證集損失值作為指標，是因為如果訓練集的損失值(loss)持續下降，但驗證集損失值卻上升，這表示模型的泛化能力變差，發生了過擬合(overfitting)，此時應該停止訓練。</li>
</ul>
</li>
</ol>
</blockquote>
<p>訓練完成後，則會輸出最佳模型的最終訓練結果。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">Trial</span> <span class="number">1</span> <span class="string">Complete</span> [<span class="string">00h</span> <span class="string">21m</span> <span class="string">05s</span>] <span class="comment"># 第1次嘗試總耗時21分5秒</span></span><br><span class="line"><span class="attr">val_loss:</span> <span class="number">0.04181874915957451</span> <span class="comment"># 驗證集上的損失值</span></span><br><span class="line"></span><br><span class="line"><span class="attr">Best val_loss So Far:</span> <span class="number">0.04181874915957451</span> <span class="comment"># 目前為止最佳的驗證集損失值</span></span><br><span class="line"><span class="attr">Total elapsed time:</span> <span class="string">00h</span> <span class="string">21m</span> <span class="string">05s</span> <span class="comment"># 總耗時</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 每個訓練週期(Epoch)的訓練過程和結果，包含每個週期的準確率(accuracy)和損失值(loss)</span></span><br><span class="line"><span class="string">Epoch</span> <span class="number">1</span><span class="string">/10</span></span><br><span class="line"><span class="number">1875</span><span class="string">/1875</span> <span class="string">━━━━━━━━━━━━━━━━━━━━</span> <span class="attr">150s 79ms/step - accuracy: 0.9068 - loss:</span> <span class="number">0.3083</span></span><br><span class="line"><span class="string">Epoch</span> <span class="number">2</span><span class="string">/10</span></span><br><span class="line"><span class="number">1875</span><span class="string">/1875</span> <span class="string">━━━━━━━━━━━━━━━━━━━━</span> <span class="attr">144s 77ms/step - accuracy: 0.9761 - loss:</span> <span class="number">0.0800</span></span><br><span class="line"><span class="string">Epoch</span> <span class="number">3</span><span class="string">/10</span></span><br><span class="line"><span class="number">1875</span><span class="string">/1875</span> <span class="string">━━━━━━━━━━━━━━━━━━━━</span> <span class="attr">200s 76ms/step - accuracy: 0.9807 - loss:</span> <span class="number">0.0651</span></span><br><span class="line"><span class="string">Epoch</span> <span class="number">4</span><span class="string">/10</span></span><br><span class="line"><span class="number">1875</span><span class="string">/1875</span> <span class="string">━━━━━━━━━━━━━━━━━━━━</span> <span class="attr">140s 75ms/step - accuracy: 0.9831 - loss:</span> <span class="number">0.0543</span></span><br><span class="line"><span class="string">Epoch</span> <span class="number">5</span><span class="string">/10</span></span><br><span class="line"><span class="number">1875</span><span class="string">/1875</span> <span class="string">━━━━━━━━━━━━━━━━━━━━</span> <span class="attr">141s 75ms/step - accuracy: 0.9859 - loss:</span> <span class="number">0.0461</span></span><br><span class="line"><span class="string">Epoch</span> <span class="number">6</span><span class="string">/10</span></span><br><span class="line"><span class="number">1875</span><span class="string">/1875</span> <span class="string">━━━━━━━━━━━━━━━━━━━━</span> <span class="attr">146s 78ms/step - accuracy: 0.9864 - loss:</span> <span class="number">0.0419</span></span><br><span class="line"><span class="string">Epoch</span> <span class="number">7</span><span class="string">/10</span></span><br><span class="line"><span class="number">1875</span><span class="string">/1875</span> <span class="string">━━━━━━━━━━━━━━━━━━━━</span> <span class="attr">146s 78ms/step - accuracy: 0.9873 - loss:</span> <span class="number">0.0383</span></span><br><span class="line"><span class="string">Epoch</span> <span class="number">8</span><span class="string">/10</span></span><br><span class="line"><span class="number">1875</span><span class="string">/1875</span> <span class="string">━━━━━━━━━━━━━━━━━━━━</span> <span class="attr">142s 76ms/step - accuracy: 0.9885 - loss:</span> <span class="number">0.0362</span></span><br><span class="line"><span class="string">Epoch</span> <span class="number">9</span><span class="string">/10</span></span><br><span class="line"><span class="number">1875</span><span class="string">/1875</span> <span class="string">━━━━━━━━━━━━━━━━━━━━</span> <span class="attr">141s 75ms/step - accuracy: 0.9890 - loss:</span> <span class="number">0.0349</span></span><br><span class="line"><span class="string">Epoch</span> <span class="number">10</span><span class="string">/10</span></span><br><span class="line"><span class="number">1875</span><span class="string">/1875</span> <span class="string">━━━━━━━━━━━━━━━━━━━━</span> <span class="attr">143s 76ms/step - accuracy: 0.9891 - loss:</span> <span class="number">0.0327</span></span><br><span class="line"><span class="string">&lt;keras.src.callbacks.history.History</span> <span class="string">at</span> <span class="number">0x7bf7b91d4af0</span><span class="string">&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>AutoKeras 會在所有嘗試過的模型中，自動選擇表現最好的那一個模型，並進行最終的訓練。<mark>即最佳模型會再被訓練一次，這次訓練會同時使用訓練集和驗證集的數據</mark>，這樣可以使模型學到更多的特徵，並產生最終結果。</li>
<li>目前由於 <code>max_trials</code> 參數被設為1，所以唯一一個測試的模型就是最佳模型，因此你會看到這個模型被訓練了2次。這2次差別在於:
<ul>
<li>第一次訓練時只有訓練集，每個週期訓練1500個批次(=48,000/32)。</li>
<li>第二次已經沒有驗證集，因為 AutoKeras 會合併訓練集和驗證集來做最終的訓練，所以每個週期訓練變成1875個批次(=60000/32)。</li>
</ul>
</li>
<li>若訓練時不指定 <code>epochs</code> 參數，AutoKeras 會記住模型表現最好的那個週期，並在最終訓練時給它訓練同樣次數的週期。</li>
<li><strong>模型對整個原始訓練集的預測準確率達到了 98.91%，以這麼短的訓練時間來說已經很不錯</strong>。</li>
</ul>
<h2 id="測試集評估模型效能"><a class="header-anchor" href="#測試集評估模型效能"></a>測試集評估模型效能</h2>
<h3 id="計算預測準確率"><a class="header-anchor" href="#計算預測準確率"></a>計算預測準確率</h3>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 比較測試集的預測分類和實際分類，並傳回預測準確率</span></span><br><span class="line">clf.evaluate(x_test, y_test)</span><br></pre></td></tr></table></figure>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">313</span>/<span class="number">313</span> ━━━━━━━━━━━━━━━━━━━━ <span class="number">6</span>s <span class="number">18</span>ms/step - accuracy: <span class="number">0</span>.<span class="number">9880</span> - loss: <span class="number">0</span>.<span class="number">0413</span><span class="meta"></span></span><br><span class="line"><span class="meta">[0.03329211473464966, 0.9894999861717224]</span></span><br></pre></td></tr></table></figure>
<p><code>evaluate()</code> 傳回兩個數值:</p>
<ul>
<li>第一個是損失值: 0.033</li>
<li>第二個是準確率: 98.94%</li>
</ul>
<p>我們可以發現<strong>模型對測試集的預測準確率為 98.94%，與訓練集的準確率 98.91% 很接近</strong>，這表示模型沒有發生過擬合(overfitting)問題。</p>
<h3 id="對圖像做出預測"><a class="header-anchor" href="#對圖像做出預測"></a>對圖像做出預測</h3>
<figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 產生 x_test[1234]的預測標籤</span></span><br><span class="line">predicted = clf.predict(x_test[np.<span class="keyword">new</span><span class="type">axis</span>, <span class="number">1234</span>])</span><br><span class="line"><span class="meta"># 畫出 x_test[1234]圖像</span></span><br><span class="line">plt.imshow(x_test[<span class="number">1234</span>], cmap=<span class="string">&#x27;gray&#x27;</span>)</span><br><span class="line"><span class="meta"># 在標題顯示預測標籤</span></span><br><span class="line">plt.title(f<span class="string">&#x27;Test sample predicted as: &#123;predicted[0]&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p>預測結果與真實的標籤值是相符的，代表我們的分類器對這張圖像判斷出了正確結果。<br>
<img src="https://firebasestorage.googleapis.com/v0/b/stellacoding1111.appspot.com/o/article%2FautoKeras-hello-mnist%2F7-mnist-classification-image-predicted.png?alt=media&amp;token=567c0452-b8e6-4f1a-bba9-1a6e869868f9" alt="7-mnist-classification-image-predicted"></p>
<h2 id="模型視覺化"><a class="header-anchor" href="#模型視覺化"></a>模型視覺化</h2>
<h3 id="模型架構表格"><a class="header-anchor" href="#模型架構表格"></a>模型架構表格</h3>
<figure class="highlight stan"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 將模型匯出為Keras模型</span></span><br><span class="line"><span class="title">model</span> = clf.export_model()</span><br><span class="line"><span class="comment"># 印出模型架構</span></span><br><span class="line"><span class="title">model</span>.summary()</span><br></pre></td></tr></table></figure>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">Model</span><span class="operator">:</span> <span class="string">&quot;functional&quot;</span></span><br><span class="line">┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓</span><br><span class="line">┃ <span class="variable">Layer</span> <span class="punctuation">(</span><span class="variable">type</span><span class="punctuation">)</span>                         ┃ <span class="variable">Output</span> <span class="variable">Shape</span>                ┃         <span class="variable">Param</span> <span class="type">#</span> ┃</span><br><span class="line">┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩</span><br><span class="line">│ <span class="type">input_layer</span> <span class="punctuation">(</span><span class="variable">InputLayer</span><span class="punctuation">)</span>             │ <span class="punctuation">(</span><span class="built_in">None</span><span class="operator">,</span> <span class="number">28</span><span class="operator">,</span> <span class="number">28</span><span class="punctuation">)</span>              │               <span class="number">0</span> │</span><br><span class="line">├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤</span><br><span class="line">│ <span class="type">cast_to</span><span class="type">_float32</span> <span class="punctuation">(</span><span class="variable">CastToFloat32</span><span class="punctuation">)</span>      │ <span class="punctuation">(</span><span class="built_in">None</span><span class="operator">,</span> <span class="number">28</span><span class="operator">,</span> <span class="number">28</span><span class="punctuation">)</span>              │               <span class="number">0</span> │</span><br><span class="line">├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤</span><br><span class="line">│ <span class="type">expand_last</span><span class="type">_dim</span> <span class="punctuation">(</span><span class="variable">ExpandLastDim</span><span class="punctuation">)</span>      │ <span class="punctuation">(</span><span class="built_in">None</span><span class="operator">,</span> <span class="number">28</span><span class="operator">,</span> <span class="number">28</span><span class="operator">,</span> <span class="number">1</span><span class="punctuation">)</span>           │               <span class="number">0</span> │</span><br><span class="line">├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤</span><br><span class="line">│ <span class="variable">normalization</span> <span class="punctuation">(</span><span class="variable">Normalization</span><span class="punctuation">)</span>        │ <span class="punctuation">(</span><span class="built_in">None</span><span class="operator">,</span> <span class="number">28</span><span class="operator">,</span> <span class="number">28</span><span class="operator">,</span> <span class="number">1</span><span class="punctuation">)</span>           │               <span class="number">3</span> │</span><br><span class="line">├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤</span><br><span class="line">│ <span class="variable">conv2d</span> <span class="punctuation">(</span><span class="variable">Conv2D</span><span class="punctuation">)</span>                      │ <span class="punctuation">(</span><span class="built_in">None</span><span class="operator">,</span> <span class="number">26</span><span class="operator">,</span> <span class="number">26</span><span class="operator">,</span> <span class="number">32</span><span class="punctuation">)</span>          │             <span class="number">320</span> │</span><br><span class="line">├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤</span><br><span class="line">│ <span class="type">conv2d_</span><span class="number">1</span> <span class="punctuation">(</span><span class="variable">Conv2D</span><span class="punctuation">)</span>                    │ <span class="punctuation">(</span><span class="built_in">None</span><span class="operator">,</span> <span class="number">24</span><span class="operator">,</span> <span class="number">24</span><span class="operator">,</span> <span class="number">64</span><span class="punctuation">)</span>          │          <span class="number">18</span><span class="operator">,</span><span class="number">496</span> │</span><br><span class="line">├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤</span><br><span class="line">│ <span class="type">max_pooling2d</span> <span class="punctuation">(</span><span class="variable">MaxPooling2D</span><span class="punctuation">)</span>         │ <span class="punctuation">(</span><span class="built_in">None</span><span class="operator">,</span> <span class="number">12</span><span class="operator">,</span> <span class="number">12</span><span class="operator">,</span> <span class="number">64</span><span class="punctuation">)</span>          │               <span class="number">0</span> │</span><br><span class="line">├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤</span><br><span class="line">│ <span class="variable">dropout</span> <span class="punctuation">(</span><span class="variable">Dropout</span><span class="punctuation">)</span>                    │ <span class="punctuation">(</span><span class="built_in">None</span><span class="operator">,</span> <span class="number">12</span><span class="operator">,</span> <span class="number">12</span><span class="operator">,</span> <span class="number">64</span><span class="punctuation">)</span>          │               <span class="number">0</span> │</span><br><span class="line">├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤</span><br><span class="line">│ <span class="variable">flatten</span> <span class="punctuation">(</span><span class="built_in">Flatten</span><span class="punctuation">)</span>                    │ <span class="punctuation">(</span><span class="built_in">None</span><span class="operator">,</span> <span class="number">9216</span><span class="punctuation">)</span>                │               <span class="number">0</span> │</span><br><span class="line">├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤</span><br><span class="line">│ <span class="type">dropout_</span><span class="number">1</span> <span class="punctuation">(</span><span class="variable">Dropout</span><span class="punctuation">)</span>                  │ <span class="punctuation">(</span><span class="built_in">None</span><span class="operator">,</span> <span class="number">9216</span><span class="punctuation">)</span>                │               <span class="number">0</span> │</span><br><span class="line">├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤</span><br><span class="line">│ <span class="variable">dense</span> <span class="punctuation">(</span><span class="variable">Dense</span><span class="punctuation">)</span>                        │ <span class="punctuation">(</span><span class="built_in">None</span><span class="operator">,</span> <span class="number">10</span><span class="punctuation">)</span>                  │          <span class="number">92</span><span class="operator">,</span><span class="number">170</span> │</span><br><span class="line">├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤</span><br><span class="line">│ <span class="type">classification_head</span><span class="type">_</span><span class="number">1</span> <span class="punctuation">(</span><span class="variable">Softmax</span><span class="punctuation">)</span>      │ <span class="punctuation">(</span><span class="built_in">None</span><span class="operator">,</span> <span class="number">10</span><span class="punctuation">)</span>                  │               <span class="number">0</span> │</span><br><span class="line">└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘</span><br><span class="line"> <span class="built_in">Total</span> <span class="variable">params</span><span class="operator">:</span> <span class="number">110</span><span class="operator">,</span><span class="number">989</span> <span class="punctuation">(</span><span class="number">433.55</span> <span class="variable">KB</span><span class="punctuation">)</span></span><br><span class="line"> <span class="variable">Trainable</span> <span class="variable">params</span><span class="operator">:</span> <span class="number">110</span><span class="operator">,</span><span class="number">986</span> <span class="punctuation">(</span><span class="number">433.54</span> <span class="variable">KB</span><span class="punctuation">)</span></span><br><span class="line"> <span class="variable">Non</span><span class="operator">-</span><span class="variable">trainable</span> <span class="variable">params</span><span class="operator">:</span> <span class="number">3</span> <span class="punctuation">(</span><span class="number">16.00</span> <span class="variable">B</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<h3 id="模型架構圖"><a class="header-anchor" href="#模型架構圖"></a>模型架構圖</h3>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">from tensorflow<span class="selector-class">.keras</span><span class="selector-class">.utils</span> import plot_model</span><br><span class="line"><span class="function"><span class="title">plot_model</span><span class="params">(model)</span></span></span><br></pre></td></tr></table></figure>
<p><img src="https://firebasestorage.googleapis.com/v0/b/stellacoding1111.appspot.com/o/article%2FautoKeras-hello-mnist%2F8-mnist-classification-plot-model.png?alt=media&amp;token=b20a56fe-12ab-43f1-9dcd-733fd1849a4b" alt="8-mnist-classification-plot-model"></p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tensorflow.keras.utils import plot_model</span><br><span class="line">plot_model(model, <span class="attribute">to_file</span>=<span class="string">&#x27;./mnist_model.png&#x27;</span>, <span class="attribute">show_shapes</span>=<span class="literal">True</span>, <span class="attribute">show_dtype</span>=<span class="literal">True</span>, <span class="attribute">show_layer_names</span>=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<p><img src="https://firebasestorage.googleapis.com/v0/b/stellacoding1111.appspot.com/o/article%2FautoKeras-hello-mnist%2F9-mnist-classification-plot-model-show-more.png?alt=media&amp;token=02e86f95-5c36-4af9-a98e-44f202bab164" alt="9-mnist-classification-plot-model-show-more"></p>
<h1 id="Hello-MNIST-圖像迴歸器"><a class="header-anchor" href="#Hello-MNIST-圖像迴歸器"></a>Hello MNIST: 圖像迴歸器</h1>
<p>迴歸器和分類器不同的是，<strong>迴歸器會傅回一個貼近預測值的「純量」，比如1.1或8.9，而非絕對的 0~9 整數</strong>。在此為了預測數字，會將預測值四捨五入，看看它最接近哪個整數，並將之視為最終預測結果。</p>
<h2 id="準備環境-v2"><a class="header-anchor" href="#準備環境-v2"></a>準備環境</h2>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">!pip3 install <span class="built_in">auto</span>keras</span><br></pre></td></tr></table></figure>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Successfully</span> installed autokeras-<span class="number">2</span>.<span class="number">0</span>.<span class="number">0</span> h5py-<span class="number">3</span>.<span class="number">11</span>.<span class="number">0</span> keras-<span class="number">3</span>.<span class="number">4</span>.<span class="number">1</span> keras-nlp-<span class="number">0</span>.<span class="number">14</span>.<span class="number">0</span> keras-tuner-<span class="number">1</span>.<span class="number">4</span>.<span class="number">7</span> kt-legacy-<span class="number">1</span>.<span class="number">0</span>.<span class="number">5</span> ml-dtypes-<span class="number">0</span>.<span class="number">3</span>.<span class="number">2</span> namex-<span class="number">0</span>.<span class="number">0</span>.<span class="number">8</span> optree-<span class="number">0</span>.<span class="number">11</span>.<span class="number">0</span> tensorboard-<span class="number">2</span>.<span class="number">16</span>.<span class="number">2</span> tensorflow-<span class="number">2</span>.<span class="number">16</span>.<span class="number">2</span> tensorflow-text-<span class="number">2</span>.<span class="number">16</span>.<span class="number">1</span></span><br></pre></td></tr></table></figure>
<figure class="highlight elm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="title">from</span> tensorflow.keras.datasets <span class="keyword">import</span> mnist</span><br><span class="line"><span class="keyword">import</span> autokeras <span class="keyword">as</span> ak</span><br></pre></td></tr></table></figure>
<h2 id="取得-MNIST-資料集-v3"><a class="header-anchor" href="#取得-MNIST-資料集-v3"></a>取得 MNIST 資料集</h2>
<figure class="highlight fix"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">(x_train, y_train), (x_test, y_test) </span>=<span class="string"> mnist.load_data()</span></span><br></pre></td></tr></table></figure>
<h2 id="建置圖像迴歸器"><a class="header-anchor" href="#建置圖像迴歸器"></a>建置圖像迴歸器</h2>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">reg = ak.ImageRegressor(<span class="attribute">overwrite</span>=<span class="literal">True</span>, <span class="attribute">max_trials</span>=1)</span><br><span class="line">reg.fit(x_train, y_train, <span class="attribute">epochs</span>=20)</span><br></pre></td></tr></table></figure>
<p>訓練過程中，會輸出目前模型使用的超參數，包含目前表現最佳的模型。</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Search</span>: Running Trial #<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">Value</span>             |Best Value So Far |Hyperparameter</span><br><span class="line"><span class="attribute">False</span>             |False             |image_block_1/normalize</span><br><span class="line"><span class="attribute">False</span>             |False             |image_block_1/augment</span><br><span class="line"><span class="attribute">resnet</span>            |resnet            |image_block_1/block_type</span><br><span class="line"><span class="attribute">False</span>             |False             |image_block_1/res_net_block_1/pretrained</span><br><span class="line"><span class="attribute">resnet50</span>          |resnet50          |image_block_1/res_net_block_1/version</span><br><span class="line"><span class="attribute">False</span>             |False             |image_block_1/res_net_block_1/imagenet_size</span><br><span class="line"><span class="attribute">0</span>                 |<span class="number">0</span>                 |regression_head_1/dropout</span><br><span class="line"><span class="attribute">adam</span>              |adam              |optimizer</span><br><span class="line"><span class="attribute">0</span>.<span class="number">001</span>             |<span class="number">0</span>.<span class="number">001</span>             |learning_rate</span><br><span class="line"></span><br><span class="line"><span class="attribute">Epoch</span> <span class="number">1</span>/<span class="number">20</span></span><br><span class="line"><span class="attribute">1500</span>/<span class="number">1500</span> ━━━━━━━━━━━━━━━━━━━━ <span class="number">122</span>s <span class="number">36</span>ms/step - loss: <span class="number">4</span>.<span class="number">0871</span> - mean_squared_error: <span class="number">4</span>.<span class="number">0871</span> - val_loss: <span class="number">1</span>.<span class="number">1759</span> - val_mean_squared_error: <span class="number">1</span>.<span class="number">1759</span></span><br><span class="line"><span class="attribute">Epoch</span> <span class="number">2</span>/<span class="number">20</span></span><br><span class="line"><span class="attribute">1500</span>/<span class="number">1500</span> ━━━━━━━━━━━━━━━━━━━━ <span class="number">50</span>s <span class="number">33</span>ms/step - loss: <span class="number">0</span>.<span class="number">6240</span> - mean_squared_error: <span class="number">0</span>.<span class="number">6240</span> - val_loss: <span class="number">0</span>.<span class="number">4633</span> - val_mean_squared_error: <span class="number">0</span>.<span class="number">4633</span></span><br><span class="line"><span class="attribute">Epoch</span> <span class="number">3</span>/<span class="number">20</span></span><br><span class="line"><span class="attribute">1500</span>/<span class="number">1500</span> ━━━━━━━━━━━━━━━━━━━━ <span class="number">48</span>s <span class="number">32</span>ms/step - loss: <span class="number">0</span>.<span class="number">5289</span> - mean_squared_error: <span class="number">0</span>.<span class="number">5289</span> - val_loss: <span class="number">0</span>.<span class="number">5131</span> - val_mean_squared_error: <span class="number">0</span>.<span class="number">5131</span></span><br><span class="line"><span class="attribute">Epoch</span> <span class="number">4</span>/<span class="number">20</span></span><br><span class="line"><span class="attribute">1500</span>/<span class="number">1500</span> ━━━━━━━━━━━━━━━━━━━━ <span class="number">56</span>s <span class="number">37</span>ms/step - loss: <span class="number">0</span>.<span class="number">4572</span> - mean_squared_error: <span class="number">0</span>.<span class="number">4572</span> - val_loss: <span class="number">0</span>.<span class="number">3757</span> - val_mean_squared_error: <span class="number">0</span>.<span class="number">3757</span></span><br><span class="line"><span class="attribute">Epoch</span> <span class="number">5</span>/<span class="number">20</span></span><br><span class="line"><span class="attribute">1500</span>/<span class="number">1500</span> ━━━━━━━━━━━━━━━━━━━━ <span class="number">48</span>s <span class="number">32</span>ms/step - loss: <span class="number">0</span>.<span class="number">4649</span> - mean_squared_error: <span class="number">0</span>.<span class="number">4649</span> - val_loss: <span class="number">0</span>.<span class="number">8890</span> - val_mean_squared_error: <span class="number">0</span>.<span class="number">8890</span></span><br><span class="line"><span class="attribute">Epoch</span> <span class="number">6</span>/<span class="number">20</span></span><br><span class="line"><span class="attribute">1500</span>/<span class="number">1500</span> ━━━━━━━━━━━━━━━━━━━━ <span class="number">48</span>s <span class="number">32</span>ms/step - loss: <span class="number">0</span>.<span class="number">4681</span> - mean_squared_error: <span class="number">0</span>.<span class="number">4681</span> - val_loss: <span class="number">0</span>.<span class="number">4839</span> - val_mean_squared_error: <span class="number">0</span>.<span class="number">4839</span></span><br><span class="line"><span class="attribute">Epoch</span> <span class="number">7</span>/<span class="number">20</span></span><br><span class="line"><span class="attribute">1500</span>/<span class="number">1500</span> ━━━━━━━━━━━━━━━━━━━━ <span class="number">47</span>s <span class="number">31</span>ms/step - loss: <span class="number">0</span>.<span class="number">6746</span> - mean_squared_error: <span class="number">0</span>.<span class="number">6746</span> - val_loss: <span class="number">2</span>.<span class="number">2674</span> - val_mean_squared_error: <span class="number">2</span>.<span class="number">2674</span></span><br><span class="line"><span class="attribute">Epoch</span> <span class="number">8</span>/<span class="number">20</span></span><br><span class="line"><span class="attribute">1500</span>/<span class="number">1500</span> ━━━━━━━━━━━━━━━━━━━━ <span class="number">48</span>s <span class="number">32</span>ms/step - loss: <span class="number">0</span>.<span class="number">3672</span> - mean_squared_error: <span class="number">0</span>.<span class="number">3672</span> - val_loss: <span class="number">3</span>.<span class="number">1101</span> - val_mean_squared_error: <span class="number">3</span>.<span class="number">1101</span></span><br></pre></td></tr></table></figure>
<p>訓練完成後，則會輸出最佳模型的最終訓練結果。</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Trial</span> <span class="number">1</span> Complete<span class="meta"> [00h 18m 25s]</span></span><br><span class="line"><span class="attribute">val_loss</span>: <span class="number">0</span>.<span class="number">17454160749912262</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">Best</span> val_loss So Far: <span class="number">0</span>.<span class="number">17454160749912262</span></span><br><span class="line"><span class="attribute">Total</span> elapsed time: <span class="number">00</span>h <span class="number">18</span>m <span class="number">25</span>s</span><br><span class="line"><span class="attribute">Epoch</span> <span class="number">1</span>/<span class="number">20</span></span><br><span class="line"><span class="attribute">1875</span>/<span class="number">1875</span> ━━━━━━━━━━━━━━━━━━━━ <span class="number">118</span>s <span class="number">31</span>ms/step - loss: <span class="number">3</span>.<span class="number">3630</span> - mean_squared_error: <span class="number">3</span>.<span class="number">3630</span></span><br><span class="line"><span class="attribute">Epoch</span> <span class="number">2</span>/<span class="number">20</span></span><br><span class="line"><span class="attribute">1875</span>/<span class="number">1875</span> ━━━━━━━━━━━━━━━━━━━━ <span class="number">58</span>s <span class="number">31</span>ms/step - loss: <span class="number">0</span>.<span class="number">5886</span> - mean_squared_error: <span class="number">0</span>.<span class="number">5886</span></span><br><span class="line"><span class="attribute">Epoch</span> <span class="number">3</span>/<span class="number">20</span></span><br><span class="line"><span class="attribute">1875</span>/<span class="number">1875</span> ━━━━━━━━━━━━━━━━━━━━ <span class="number">58</span>s <span class="number">31</span>ms/step - loss: <span class="number">0</span>.<span class="number">5281</span> - mean_squared_error: <span class="number">0</span>.<span class="number">5281</span></span><br><span class="line"><span class="attribute">Epoch</span> <span class="number">4</span>/<span class="number">20</span></span><br><span class="line"><span class="attribute">1875</span>/<span class="number">1875</span> ━━━━━━━━━━━━━━━━━━━━ <span class="number">82</span>s <span class="number">31</span>ms/step - loss: <span class="number">0</span>.<span class="number">4323</span> - mean_squared_error: <span class="number">0</span>.<span class="number">4323</span></span><br><span class="line"><span class="attribute">Epoch</span> <span class="number">5</span>/<span class="number">20</span></span><br><span class="line"><span class="attribute">1875</span>/<span class="number">1875</span> ━━━━━━━━━━━━━━━━━━━━ <span class="number">57</span>s <span class="number">30</span>ms/step - loss: <span class="number">0</span>.<span class="number">5396</span> - mean_squared_error: <span class="number">0</span>.<span class="number">5396</span></span><br><span class="line"><span class="attribute">Epoch</span> <span class="number">6</span>/<span class="number">20</span></span><br><span class="line"><span class="attribute">1875</span>/<span class="number">1875</span> ━━━━━━━━━━━━━━━━━━━━ <span class="number">58</span>s <span class="number">31</span>ms/step - loss: <span class="number">0</span>.<span class="number">3970</span> - mean_squared_error: <span class="number">0</span>.<span class="number">3970</span></span><br><span class="line"><span class="attribute">Epoch</span> <span class="number">7</span>/<span class="number">20</span></span><br><span class="line"><span class="attribute">1875</span>/<span class="number">1875</span> ━━━━━━━━━━━━━━━━━━━━ <span class="number">58</span>s <span class="number">31</span>ms/step - loss: <span class="number">0</span>.<span class="number">4000</span> - mean_squared_error: <span class="number">0</span>.<span class="number">4000</span></span><br><span class="line"><span class="attribute">Epoch</span> <span class="number">8</span>/<span class="number">20</span></span><br><span class="line"><span class="attribute">1875</span>/<span class="number">1875</span> ━━━━━━━━━━━━━━━━━━━━ <span class="number">82</span>s <span class="number">31</span>ms/step - loss: <span class="number">0</span>.<span class="number">3490</span> - mean_squared_error: <span class="number">0</span>.<span class="number">3490</span></span><br><span class="line"><span class="attribute">Epoch</span> <span class="number">9</span>/<span class="number">20</span></span><br><span class="line"><span class="attribute">1875</span>/<span class="number">1875</span> ━━━━━━━━━━━━━━━━━━━━ <span class="number">57</span>s <span class="number">31</span>ms/step - loss: <span class="number">0</span>.<span class="number">2903</span> - mean_squared_error: <span class="number">0</span>.<span class="number">2903</span></span><br><span class="line"><span class="attribute">Epoch</span> <span class="number">10</span>/<span class="number">20</span></span><br><span class="line"><span class="attribute">1875</span>/<span class="number">1875</span> ━━━━━━━━━━━━━━━━━━━━ <span class="number">84</span>s <span class="number">32</span>ms/step - loss: <span class="number">0</span>.<span class="number">2293</span> - mean_squared_error: <span class="number">0</span>.<span class="number">2293</span></span><br><span class="line"><span class="attribute">Epoch</span> <span class="number">11</span>/<span class="number">20</span></span><br><span class="line"><span class="attribute">1875</span>/<span class="number">1875</span> ━━━━━━━━━━━━━━━━━━━━ <span class="number">58</span>s <span class="number">31</span>ms/step - loss: <span class="number">0</span>.<span class="number">2057</span> - mean_squared_error: <span class="number">0</span>.<span class="number">2057</span></span><br><span class="line"><span class="attribute">Epoch</span> <span class="number">12</span>/<span class="number">20</span></span><br><span class="line"><span class="attribute">1875</span>/<span class="number">1875</span> ━━━━━━━━━━━━━━━━━━━━ <span class="number">58</span>s <span class="number">31</span>ms/step - loss: <span class="number">0</span>.<span class="number">1904</span> - mean_squared_error: <span class="number">0</span>.<span class="number">1904</span></span><br><span class="line"><span class="attribute">Epoch</span> <span class="number">13</span>/<span class="number">20</span></span><br><span class="line"><span class="attribute">1875</span>/<span class="number">1875</span> ━━━━━━━━━━━━━━━━━━━━ <span class="number">84</span>s <span class="number">32</span>ms/step - loss: <span class="number">0</span>.<span class="number">1911</span> - mean_squared_error: <span class="number">0</span>.<span class="number">1911</span></span><br><span class="line"><span class="attribute">Epoch</span> <span class="number">14</span>/<span class="number">20</span></span><br><span class="line"><span class="attribute">1875</span>/<span class="number">1875</span> ━━━━━━━━━━━━━━━━━━━━ <span class="number">58</span>s <span class="number">31</span>ms/step - loss: <span class="number">0</span>.<span class="number">1596</span> - mean_squared_error: <span class="number">0</span>.<span class="number">1596</span></span><br><span class="line"><span class="attribute">Epoch</span> <span class="number">15</span>/<span class="number">20</span></span><br><span class="line"><span class="attribute">1875</span>/<span class="number">1875</span> ━━━━━━━━━━━━━━━━━━━━ <span class="number">82</span>s <span class="number">31</span>ms/step - loss: <span class="number">0</span>.<span class="number">1527</span> - mean_squared_error: <span class="number">0</span>.<span class="number">1527</span></span><br><span class="line"><span class="attribute">Epoch</span> <span class="number">16</span>/<span class="number">20</span></span><br><span class="line"><span class="attribute">1875</span>/<span class="number">1875</span> ━━━━━━━━━━━━━━━━━━━━ <span class="number">57</span>s <span class="number">31</span>ms/step - loss: <span class="number">0</span>.<span class="number">1361</span> - mean_squared_error: <span class="number">0</span>.<span class="number">1361</span></span><br><span class="line"><span class="attribute">Epoch</span> <span class="number">17</span>/<span class="number">20</span></span><br><span class="line"><span class="attribute">1875</span>/<span class="number">1875</span> ━━━━━━━━━━━━━━━━━━━━ <span class="number">57</span>s <span class="number">31</span>ms/step - loss: <span class="number">0</span>.<span class="number">1056</span> - mean_squared_error: <span class="number">0</span>.<span class="number">1056</span></span><br><span class="line"><span class="attribute">Epoch</span> <span class="number">18</span>/<span class="number">20</span></span><br><span class="line"><span class="attribute">1875</span>/<span class="number">1875</span> ━━━━━━━━━━━━━━━━━━━━ <span class="number">57</span>s <span class="number">31</span>ms/step - loss: <span class="number">0</span>.<span class="number">0992</span> - mean_squared_error: <span class="number">0</span>.<span class="number">0992</span></span><br><span class="line"><span class="attribute">Epoch</span> <span class="number">19</span>/<span class="number">20</span></span><br><span class="line"><span class="attribute">1875</span>/<span class="number">1875</span> ━━━━━━━━━━━━━━━━━━━━ <span class="number">59</span>s <span class="number">31</span>ms/step - loss: <span class="number">0</span>.<span class="number">1010</span> - mean_squared_error: <span class="number">0</span>.<span class="number">1010</span></span><br><span class="line"><span class="attribute">Epoch</span> <span class="number">20</span>/<span class="number">20</span></span><br><span class="line"><span class="attribute">1875</span>/<span class="number">1875</span> ━━━━━━━━━━━━━━━━━━━━ <span class="number">58</span>s <span class="number">31</span>ms/step - loss: <span class="number">0</span>.<span class="number">0957</span> - mean_squared_error: <span class="number">0</span>.<span class="number">0957</span></span><br><span class="line"><span class="section">&lt;keras.src.callbacks.history.History at 0x7ef7602e47f0&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>模型訓練時，模型會更新權重，並試著讓均方誤差(Mean Square Error, MSE)最小化。</li>
<li><strong>我們最終得到的 MSE 為 0.0957，其平方根即為均方根誤差(RMSE)為 0.3094</strong>。</li>
<li>RMSE 為 0.3094，表示平均每個預測值與真實值之間的差距約為 0.3094，也就是指此模型的平均預測誤差約為 0.3094。</li>
</ul>
<div class="note info"><p>均方誤差(mean square error, MSE)，表示預測值與真實值之間的差距，是所有預測值與真實值的差距的平方和的平均值。通常一個較小的 MSE 或 RMSE 表示模型的預測精度較高。關於機器學習迴歸模型中常見的的效能衡量指標，請看 <a href="https://estellacoding.github.io/blog/regression-metrics-mse-rmse-mae-r2/">機器學習中迴歸模型的效能衡量指標</a> 這篇文章。</p>
</div>
<h2 id="測試集評估模型效能-v2"><a class="header-anchor" href="#測試集評估模型效能-v2"></a>測試集評估模型效能</h2>
<h3 id="計算均方誤差"><a class="header-anchor" href="#計算均方誤差"></a>計算均方誤差</h3>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">print</span><span class="params">(reg.evaluate(x_test, y_test)</span></span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">313</span>/<span class="number">313</span> ━━━━━━━━━━━━━━━━━━━━ <span class="number">11</span>s <span class="number">15</span>ms/step - loss: <span class="number">0</span>.<span class="number">1685</span> - mean_squared_error: <span class="number">0</span>.<span class="number">1685</span><span class="meta"></span></span><br><span class="line"><span class="meta">[0.1497689187526703, 0.1497689187526703]</span></span><br></pre></td></tr></table></figure>
<p>我們可以發現，模型在測試集上的預測均方誤差(MSE)為 0.1498，其均方根誤差(RMSE)約為 0.387。</p>
<h3 id="對圖像做出預測-v2"><a class="header-anchor" href="#對圖像做出預測-v2"></a>對圖像做出預測</h3>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 取得測試集的前10個預測結果，轉成一維後四捨五入，並轉成整數格式</span></span><br><span class="line"><span class="attribute">predicted</span> = reg.predict(x_test[:<span class="number">10</span>]).flatten().round().astype(&#x27;uint8&#x27;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 印出前10筆資料的真實標籤與預測標籤</span></span><br><span class="line"><span class="attribute">print</span>(y_test[:<span class="number">10</span>])</span><br><span class="line"><span class="attribute">print</span>(predicted)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 顯示測試集前10筆資料圖像，其標題為預測標籤</span></span><br><span class="line"><span class="attribute">fig</span> = plt.figure()</span><br><span class="line"><span class="attribute">for</span> i in range(<span class="number">10</span>):</span><br><span class="line">    <span class="comment"># 子畫布以5x2格排列</span></span><br><span class="line">    <span class="attribute">ax</span> = fig.add_subplot(<span class="number">2</span>, <span class="number">5</span>, i + <span class="number">1</span>)</span><br><span class="line">    <span class="comment"># 隱藏座標軸</span></span><br><span class="line">    <span class="attribute">ax</span>.set_axis_off() </span><br><span class="line">    <span class="attribute">plt</span>.imshow(x_test[i], cmap=&#x27;gray&#x27;)</span><br><span class="line">    <span class="attribute">ax</span>.set_title(predicted[i])</span><br><span class="line"><span class="attribute">plt</span>.show()</span><br></pre></td></tr></table></figure>
<figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1/1 ━━━━━━━━━━━━━━━━━━━━ 5s 5s/step</span><br><span class="line">1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 9ms/step</span><br><span class="line">[7<span class="number"> 2 </span>1<span class="number"> 0 </span>4<span class="number"> 1 </span>4<span class="number"> 9 </span>5 9] <span class="comment"># 真實標籤</span></span><br><span class="line">[7<span class="number"> 2 </span>1<span class="number"> 0 </span>4<span class="number"> 1 </span>5<span class="number"> 9 </span>5 9] <span class="comment"># 預測標籤</span></span><br></pre></td></tr></table></figure>
<p><img src="https://firebasestorage.googleapis.com/v0/b/stellacoding1111.appspot.com/o/article%2FautoKeras-hello-mnist%2F10-mnist-regression-image-predicted.png?alt=media&amp;token=ccba23be-08e8-4037-b998-c3802a36fee8" alt="10-mnist-regression-image-predicted"></p>
<p>可見儘管迴歸器的預測值不是整數，但只要訓練時得到的均方誤差(MSE)夠小，四捨五入後還是能貼近真實標籤。不過一般來說，迴歸模型的用途大多還是用在預測非離散的數值，例如房價等。</p>
<h2 id="模型視覺化-v2"><a class="header-anchor" href="#模型視覺化-v2"></a>模型視覺化</h2>
<h3 id="模型架構表格-v2"><a class="header-anchor" href="#模型架構表格-v2"></a>模型架構表格</h3>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">model</span> <span class="operator">=</span> reg.export_model()</span><br><span class="line">model.summary()</span><br></pre></td></tr></table></figure>
<figure class="highlight prolog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">Model</span>: <span class="string">&quot;functional&quot;</span></span><br><span class="line">┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┓</span><br><span class="line">┃ <span class="symbol">Layer</span> (type)              ┃ <span class="symbol">Output</span> <span class="symbol">Shape</span>           ┃        <span class="symbol">Param</span> # ┃ <span class="symbol">Connected</span> to           ┃</span><br><span class="line">┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━┩</span><br><span class="line">│ input_layer (<span class="symbol">InputLayer</span>)  │ (<span class="symbol">None</span>, <span class="number">28</span>, <span class="number">28</span>)         │              <span class="number">0</span> │ -                      │</span><br><span class="line">├───────────────────────────┼────────────────────────┼────────────────┼────────────────────────┤</span><br><span class="line">│ cast_to_float32           │ (<span class="symbol">None</span>, <span class="number">28</span>, <span class="number">28</span>)         │              <span class="number">0</span> │ input_layer[<span class="number">0</span>][<span class="number">0</span>]      │</span><br><span class="line">│ (<span class="symbol">CastToFloat32</span>)           │                        │                │                        │</span><br><span class="line">├───────────────────────────┼────────────────────────┼────────────────┼────────────────────────┤</span><br><span class="line">│ expand_last_dim           │ (<span class="symbol">None</span>, <span class="number">28</span>, <span class="number">28</span>, <span class="number">1</span>)      │              <span class="number">0</span> │ cast_to_float32[<span class="number">0</span>][<span class="number">0</span>]  │</span><br><span class="line">│ (<span class="symbol">ExpandLastDim</span>)           │                        │                │                        │</span><br><span class="line">├───────────────────────────┼────────────────────────┼────────────────┼────────────────────────┤</span><br><span class="line">│ resizing (<span class="symbol">Resizing</span>)       │ (<span class="symbol">None</span>, <span class="number">32</span>, <span class="number">32</span>, <span class="number">1</span>)      │              <span class="number">0</span> │ expand_last_dim[<span class="number">0</span>][<span class="number">0</span>]  │</span><br><span class="line">├───────────────────────────┼────────────────────────┼────────────────┼────────────────────────┤</span><br><span class="line">│ concatenate (<span class="symbol">Concatenate</span>) │ (<span class="symbol">None</span>, <span class="number">32</span>, <span class="number">32</span>, <span class="number">3</span>)      │              <span class="number">0</span> │ resizing[<span class="number">0</span>][<span class="number">0</span>],        │</span><br><span class="line">│                           │                        │                │ resizing[<span class="number">0</span>][<span class="number">0</span>],        │</span><br><span class="line">│                           │                        │                │ resizing[<span class="number">0</span>][<span class="number">0</span>]         │</span><br><span class="line">├───────────────────────────┼────────────────────────┼────────────────┼────────────────────────┤</span><br><span class="line">│ resnet50 (<span class="symbol">Functional</span>)     │ (<span class="symbol">None</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2048</span>)     │     <span class="number">23</span>,<span class="number">587</span>,<span class="number">712</span> │ concatenate[<span class="number">0</span>][<span class="number">0</span>]      │</span><br><span class="line">├───────────────────────────┼────────────────────────┼────────────────┼────────────────────────┤</span><br><span class="line">│ flatten (<span class="symbol">Flatten</span>)         │ (<span class="symbol">None</span>, <span class="number">2048</span>)           │              <span class="number">0</span> │ resnet50[<span class="number">0</span>][<span class="number">0</span>]         │</span><br><span class="line">├───────────────────────────┼────────────────────────┼────────────────┼────────────────────────┤</span><br><span class="line">│ regression_head_1 (<span class="symbol">Dense</span>) │ (<span class="symbol">None</span>, <span class="number">1</span>)              │          <span class="number">2</span>,<span class="number">049</span> │ flatten[<span class="number">0</span>][<span class="number">0</span>]          │</span><br><span class="line">└───────────────────────────┴────────────────────────┴────────────────┴────────────────────────┘</span><br><span class="line"> <span class="symbol">Total</span> params: <span class="number">23</span>,<span class="number">589</span>,<span class="number">761</span> (<span class="number">89.99</span> <span class="symbol">MB</span>)</span><br><span class="line"> <span class="symbol">Trainable</span> params: <span class="number">23</span>,<span class="number">536</span>,<span class="number">641</span> (<span class="number">89.79</span> <span class="symbol">MB</span>)</span><br><span class="line"> <span class="symbol">Non</span>-trainable params: <span class="number">53</span>,<span class="number">120</span> (<span class="number">207.50</span> <span class="symbol">KB</span>)</span><br></pre></td></tr></table></figure>
<h3 id="模型架構圖-v2"><a class="header-anchor" href="#模型架構圖-v2"></a>模型架構圖</h3>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">from tensorflow<span class="selector-class">.keras</span><span class="selector-class">.utils</span> import plot_model</span><br><span class="line"><span class="function"><span class="title">plot_model</span><span class="params">(model)</span></span></span><br></pre></td></tr></table></figure>
<p><img src="https://firebasestorage.googleapis.com/v0/b/stellacoding1111.appspot.com/o/article%2FautoKeras-hello-mnist%2F11-mnist-regression-plot-model.png?alt=media&amp;token=334e34ac-6218-4ab8-989f-554eb185f9c3" alt="11-mnist-regression-plot-model"></p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tensorflow.keras.utils import plot_model</span><br><span class="line">plot_model(model, <span class="attribute">to_file</span>=<span class="string">&#x27;./mnist_model.png&#x27;</span>, <span class="attribute">show_shapes</span>=<span class="literal">True</span>, <span class="attribute">show_dtype</span>=<span class="literal">True</span>, <span class="attribute">show_layer_names</span>=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<p><img src="https://firebasestorage.googleapis.com/v0/b/stellacoding1111.appspot.com/o/article%2FautoKeras-hello-mnist%2F12-mnist-regression-plot-model-show-more.png?alt=media&amp;token=0c493681-8335-4484-985b-b9b423d4a1d7" alt="12-mnist-regression-plot-model-show-more"></p>
<h1 id="總結"><a class="header-anchor" href="#總結"></a>總結</h1>
<p>本篇文章詳細介紹了如何在不同環境下如何安裝 AutoKeras，並使用 AutoKeras 來訓練 MNIST 的圖像分類器和迴歸器，從環境配置、資料集準備、模型訓練到最終評估，逐步展示了每個過程的詳細步驟。</p>
<p>AutoKeras 框架讓我們實現短短幾行程式碼下，就能針對手寫數字圖像實作出高預測精確度的圖像分類器和迴歸器模型。關於如何準備資料集，請看 <a href="https://estellacoding.github.io/blog/autokeras-data-folder/">【AutoKeras】準備資料集及資料夾結構</a> 這篇文章。</p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/blog/tags/AutoML/" rel="tag"># AutoML</a>
              <a href="/blog/tags/Machine-Learning/" rel="tag"># Machine Learning</a>
              <a href="/blog/tags/Deep-Learning/" rel="tag"># Deep Learning</a>
              <a href="/blog/tags/AutoKeras/" rel="tag"># AutoKeras</a>
              <a href="/blog/tags/MNIST/" rel="tag"># MNIST</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/blog/win11-activate-nvidia-mx450-gpu-locally/" rel="prev" title="Win11 本地端啟動 NVIDIA MX450 GPU 的詳細步驟">
                  <i class="fa fa-angle-left"></i> Win11 本地端啟動 NVIDIA MX450 GPU 的詳細步驟
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/blog/fsevents-node-issue/" rel="next" title="部署 Hexo 時無法打開「fsevents.node」">
                  部署 Hexo 時無法打開「fsevents.node」 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments gitalk-container"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Stella</span>
  </div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/blog/js/comments.js"></script><script src="/blog/js/utils.js"></script><script src="/blog/js/motion.js"></script><script src="/blog/js/sidebar.js"></script><script src="/blog/js/next-boot.js"></script>

  

  <script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":{"light":"default","dark":"dark"},"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.9.0/mermaid.min.js","integrity":"sha256-stuqcu2FrjYCXDOytWFA5SoUE/r3nkp6gTglzNSlavU="}}</script>
  <script src="/blog/js/third-party/tags/mermaid.js"></script>





  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"ams","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/blog/js/third-party/math/mathjax.js"></script>


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.8.0/gitalk.css" integrity="sha256-AJnUHL7dBv6PGaeyPQJcgQPDjt/Hn/PvYZde1iqfp8U=" crossorigin="anonymous">

<script class="next-config" data-name="gitalk" type="application/json">{"enable":true,"github_id":"estellacoding","repo":"blog","client_id":"Ov23liBnWPuObZGktbAv","client_secret":"9ed6e261cd75af620744058daafa56b80a53ffa8","admin_user":"estellacoding","distraction_free_mode":true,"proxy":"https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token","language":null,"labels":"gitalk","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.8.0/gitalk.min.js","integrity":"sha256-MVK9MGD/XJaGyIghSVrONSnoXoGh3IFxLw0zfvzpxR4="},"path_md5":"fab097b5d560ba8b038b242d9948c319"}</script>
<script src="/blog/js/third-party/comments/gitalk.js"></script>

</body>
</html>
